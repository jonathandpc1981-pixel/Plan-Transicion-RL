import React, { useState, useEffect } from 'react';
import { 
  Shield, 
  Zap, 
  BarChart3, 
  Globe, 
  Lock, 
  Users, 
  ChevronRight, 
  AlertTriangle, 
  Database, 
  Cpu, 
  Briefcase, 
  Eye,
  Scale,
  DollarSign
} from 'lucide-react';
import {
  Chart as ChartJS,
  CategoryScale,
  LinearScale,
  PointElement,
  LineElement,
  BarElement,
  ArcElement,
  Title,
  Tooltip,
  Legend,
  Filler
} from 'chart.js';
import { Line, Doughnut, Bar } from 'react-chartjs-2';

ChartJS.register(
  CategoryScale,
  LinearScale,
  PointElement,
  LineElement,
  BarElement,
  ArcElement,
  Title,
  Tooltip,
  Legend,
  Filler
);

const App = () => {
  const [activeTab, setActiveTab] = useState('dashboard');
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    // Simulación de carga de datos estratégicos
    const timer = setTimeout(() => setLoading(false), 800);
    return () => clearTimeout(timer);
  }, []);

  // --- CONFIGURACIÓN DE GRÁFICOS (Corregido y Expandido) ---
  const lineData = {
    labels: ['Día 1', 'Semana 1', 'Mes 1', 'Mes 6', 'Año 1'],
    datasets: [
      {
        label: 'Control Territorial (%)',
        data: [12, 45, 68, 85, 98],
        borderColor: '#fbbf24',
        backgroundColor: 'rgba(251, 191, 36, 0.1)',
        fill: true,
        tension: 0.4,
      },
    ],
  };

  const doughnutData = {
    labels: ['Seguridad/Defensa', 'Logística/Alimentos', 'Energía/Infra', 'Justicia/Vetting'],
    datasets: [
      {
        data: [40, 25, 20, 15],
        backgroundColor: ['#1e40af', '#10b981', '#f59e0b', '#ef4444'],
        borderWidth: 0,
      },
    ],
  };

  const barData = {
    labels: ['Oil & Gas', 'Tech/Gov', 'Agro', 'Telecom'],
    datasets: [
      {
        label: 'Inversión Proyectada (Billones $)',
        data: [4.5, 1.2, 0.8, 2.1],
        backgroundColor: '#3b82f6',
      },
    ],
  };

  const renderContent = () => {
    switch (activeTab) {
      case 'dashboard':
        return (
          <div className="space-y-6 animate-in fade-in duration-500">
            {/* Métricas Críticas */}
            <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
              <MetricCard title="Fuerza Efectiva" value="45%" status="Saturación" icon={<Shield className="text-blue-500" />} />
              <MetricCard title="Riesgo Sabotaje" value="CRÍTICO" status="Alerta Roja" icon={<AlertTriangle className="text-red-500" />} color="text-red-500" />
              <MetricCard title="Legitimidad Funcional" value="82%" status="Reconocimiento" icon={<Globe className="text-emerald-500" />} />
              <MetricCard title="Caja Recuperada" value="$420M" status="Fase 1" icon={<DollarSign className="text-amber-500" />} />
            </div>

            <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
              <div className="bg-slate-900 border border-slate-800 p-6 rounded-xl">
                <h3 className="text-slate-200 font-bold mb-4 flex items-center gap-2 uppercase tracking-tighter">
                  <BarChart3 size={18} className="text-amber-400" /> Proyección de Estabilización
                </h3>
                <div className="h-64">
                  <Line data={lineData} options={{ maintainAspectRatio: false, scales: { y: { grid: { color: '#1e293b' }, ticks: { color: '#64748b' } }, x: { grid: { display: false }, ticks: { color: '#64748b' } } }, plugins: { legend: { display: false } } }} />
                </div>
              </div>

              <div className="bg-slate-900 border border-slate-800 p-6 rounded-xl">
                <h3 className="text-slate-200 font-bold mb-4 flex items-center gap-2 uppercase tracking-tighter">
                  <Zap size={18} className="text-emerald-400" /> Prioridades de Gasto H-0
                </h3>
                <div className="h-64 flex justify-center">
                  <Doughnut data={doughnutData} options={{ maintainAspectRatio: false, plugins: { legend: { position: 'bottom', labels: { color: '#94a3b8', padding: 20 } } } }} />
                </div>
              </div>
            </div>

            {/* Fases del Plan Maestro */}
            <div className="bg-slate-900 border border-slate-800 p-6 rounded-xl">
              <h3 className="text-slate-200 font-bold mb-6 uppercase tracking-widest flex items-center gap-2">
                <ChevronRight className="text-amber-500" /> Resumen Ejecución "Ruptura Hegemónica"
              </h3>
              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <TaskItem 
                  title="Operación Ola Verde (72h)" 
                  desc="Apertura total de fronteras. Libre importación sin aranceles. Escoltas militares para convoyes privados de alimentos." 
                  status="Prioridad 1"
                />
                <TaskItem 
                  title="Billetera Libre" 
                  desc="Transferencia directa de $50-$100 USD en stablecoins para neutralizar saqueos por hambre ('No saques, compra')." 
                  status="Prioridad 1"
                />
                <TaskItem 
                  title="Vetting ANP" 
                  desc="Lustración y depuración de fuerzas policiales usando polígrafo y auditoría de vida. Disolución del SEBIN/DGCIM." 
                  status="En Curso"
                />
              </div>
            </div>
          </div>
        );

      case 'security':
        return (
          <div className="space-y-6 animate-in slide-in-from-bottom-4 duration-500">
            <div className="bg-slate-900 border border-slate-800 p-8 rounded-xl">
              <h2 className="text-2xl font-black text-white mb-6 italic uppercase tracking-tighter border-b border-slate-800 pb-4">
                SSR: Reforma del Sector Seguridad e Inteligencia
              </h2>
              <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div className="space-y-4">
                  <h3 className="text-amber-400 font-bold uppercase text-sm">Alianza Estratégica con Israel</h3>
                  <div className="bg-slate-800/50 p-4 rounded border-l-4 border-blue-500">
                    <p className="text-slate-300 text-sm font-bold mb-2">Unidad NBCTF (Counter Terror Financing):</p>
                    <p className="text-slate-400 text-xs leading-relaxed">Implementación de rastreo de activos financieros de Hezbollah e Irán. Identificación de lavado de dinero del Cártel de los Soles.</p>
                  </div>
                  <div className="bg-slate-800/50 p-4 rounded border-l-4 border-blue-500">
                    <p className="text-slate-300 text-sm font-bold mb-2">Integridad Documental (SAIME Audit):</p>
                    <p className="text-slate-400 text-xs leading-relaxed">Invalidación masiva de visas y pasaportes otorgados a células terroristas extranjeras.</p>
                  </div>
                </div>
                <div className="space-y-4">
                  <h3 className="text-red-500 font-bold uppercase text-sm">Reglas de Enfrentamiento (ROE)</h3>
                  <div className="bg-red-950/20 p-4 rounded border border-red-500/30">
                    <p className="text-red-200 text-sm font-bold mb-1">Doctrina FM 3-07:</p>
                    <p className="text-slate-400 text-xs">Los colectivos armados y grupos paraestatales son clasificados como 'Enemigos Combatientes'. Uso de fuerza letal autorizado ante sabotaje de infraestructura crítica.</p>
                  </div>
                  <div className="bg-slate-800/50 p-4 rounded border-l-4 border-slate-400">
                    <p className="text-slate-300 text-sm font-bold mb-1">Monopolio de la Fuerza:</p>
                    <p className="text-slate-400 text-xs">Desarme urbano obligatorio. Prohibición total de porte de armas a civiles no registrados.</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        );

      case 'economy':
        return (
          <div className="space-y-6 animate-in slide-in-from-bottom-4">
            <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
              <div className="lg:col-span-2 bg-slate-900 border border-slate-800 p-8 rounded-xl">
                <h2 className="text-2xl font-black text-white mb-6 uppercase italic tracking-tighter">Shock de Estabilización y Propiedad</h2>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div className="p-4 bg-emerald-950/10 border border-emerald-900/30 rounded">
                    <h4 className="text-emerald-400 font-bold text-sm mb-2">Agencia de Hidrocarburos</h4>
                    <p className="text-slate-400 text-xs">PDVSA deja de ser operador. Se convierte en regulador. Concesiones directas a 20 años con arbitraje internacional.</p>
                  </div>
                  <div className="p-4 bg-blue-950/10 border border-blue-900/30 rounded">
                    <h4 className="text-blue-400 font-bold text-sm mb-2">Dolarización y Banca</h4>
                    <p className="text-slate-400 text-xs">Adopción del USD. Clearing local en divisas. Entrada de banca internacional (USA/Israel/EU) inmediata.</p>
                  </div>
                  <div className="p-4 bg-amber-950/10 border border-amber-900/30 rounded">
                    <h4 className="text-amber-400 font-bold text-sm mb-2">Fondo Patrimonial</h4>
                    <p className="text-slate-400 text-xs">Regalías al ciudadano. El Estado no administra el ingreso: el ciudadano recibe su dividendo.</p>
                  </div>
                  <div className="p-4 bg-slate-800/30 border border-slate-700/30 rounded">
                    <h4 className="text-slate-300 font-bold text-sm mb-2">Devolución de Tierras</h4>
                    <p className="text-slate-400 text-xs">Restitución inmediata de propiedades confiscadas. Títulos inmutables registrados en Blockchain.</p>
                  </div>
                </div>
              </div>
              <div className="bg-slate-900 border border-slate-800 p-6 rounded-xl">
                <h3 className="text-slate-200 font-bold mb-4 uppercase text-xs">Pitch Davos: ROI Proyectado</h3>
                <div className="h-48">
                  <Bar data={barData} options={{ maintainAspectRatio: false, plugins: { legend: { display: false } } }} />
                </div>
                <div className="mt-4 p-4 bg-slate-800 rounded text-[10px] text-slate-400 leading-relaxed italic">
                  "No pedimos fe, ofrecemos estructura fiduciaria blindada y arbitraje internacional desde el día 1."
                </div>
              </div>
            </div>
          </div>
        );

      case 'tech':
        return (
          <div className="space-y-6 animate-in slide-in-from-bottom-4">
            <div className="bg-slate-900 border border-slate-800 p-8 rounded-xl">
              <h2 className="text-2xl font-black text-white mb-6 uppercase tracking-tighter">Plan Maestro de Reestructuración Tecnológica</h2>
              <div className="relative border-l-2 border-slate-700 ml-4 space-y-8">
                <TimelineStep 
                  step="Fase 1: Legal" 
                  desc="Reestructuración de leyes para garantizar respeto absoluto a la inversión privada tecnológica." 
                />
                <TimelineStep 
                  step="Fase 2 & 3: Factibilidad" 
                  desc="Levantamiento de infraestructura TV/Datos. Diseño del 'Nuevo Guri Digital'. Plan de conectividad satelital LEO." 
                />
                <TimelineStep 
                  step="Fase 4: RFI (Request for Information)" 
                  desc="Llamado a fabricantes globales (Cisco, Starlink, Huawei [vetado], etc.) para presentar soluciones y costos." 
                />
                <TimelineStep 
                  step="Fase 5: RFP (Licitación)" 
                  desc="Competencia abierta por presupuesto. Implementación de 'Open Treasury' para transparencia fiduciaria." 
                />
              </div>
            </div>
            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div className="bg-slate-900 border border-slate-800 p-6 rounded-xl flex items-center gap-4">
                <Database className="text-blue-500" size={32} />
                <div>
                  <h4 className="text-white font-bold text-sm">Open Treasury Blockchain</h4>
                  <p className="text-slate-500 text-xs">Gasto público rastreable en tiempo real.</p>
                </div>
              </div>
              <div className="bg-slate-900 border border-slate-800 p-6 rounded-xl flex items-center gap-4">
                <Cpu className="text-emerald-500" size={32} />
                <div>
                  <h4 className="text-white font-bold text-sm">Identidad Digital Soberana</h4>
                  <p className="text-slate-500 text-xs">Biometría para depuración electoral y ciudadana.</p>
                </div>
              </div>
            </div>
          </div>
        );

      case 'lustration':
        return (
          <div className="space-y-6 animate-in slide-in-from-bottom-4">
            <div className="bg-slate-900 border border-slate-800 p-8 rounded-xl">
              <div className="flex items-center gap-4 mb-8">
                <Scale className="text-red-500" size={40} />
                <h2 className="text-2xl font-black text-white uppercase italic tracking-tighter">Ley de Lustración y Poder Civil</h2>
              </div>
              <p className="text-slate-400 mb-8 text-sm italic border-b border-slate-800 pb-4">
                "La democracia sin justicia es un suicidio. Rumbo Libertad no recicla élites, las remueve."
              </p>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div className="p-6 bg-slate-950 rounded-lg border border-red-900/20">
                  <h4 className="text-red-500 font-bold mb-4 uppercase text-xs tracking-widest">Depuración Política</h4>
                  <ul className="space-y-3 text-xs text-slate-400">
                    <li className="flex items-start gap-2">• Inhabilitación perpetua para la cúpula del PSUV y Cártel de los Soles.</li>
                    <li className="flex items-start gap-2">• Inhabilitación por 10 años para la "falsa oposición" colaboracionista.</li>
                    <li className="flex items-start gap-2">• Juicios de extinción de dominio para recuperar bienes malversados.</li>
                  </ul>
                </div>
                <div className="p-6 bg-slate-950 rounded-lg border border-emerald-900/20">
                  <h4 className="text-emerald-500 font-bold mb-4 uppercase text-xs tracking-widest">Moratoria Electoral</h4>
                  <ul className="space-y-3 text-xs text-slate-400">
                    <li className="flex items-start gap-2">• Periodo de Estabilización (24-36 meses) sin elecciones generales.</li>
                    <li className="flex items-start gap-2">• La legitimidad inicial es FUNCIONAL, basada en el Orden y el Rescate.</li>
                    <li className="flex items-start gap-2">• Nuevo Censo Biométrico como condición para el voto futuro.</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        );

      default:
        return null;
    }
  };

  return (
    <div className="min-h-screen bg-slate-950 text-slate-200 font-sans selection:bg-amber-500 selection:text-black">
      {/* Barra de Navegación Lateral */}
      <div className="flex h-screen overflow-hidden">
        <aside className="w-64 bg-slate-900 border-r border-slate-800 flex flex-col shrink-0 hidden md:flex">
          <div className="p-6 flex flex-col items-center border-b border-slate-800">
            <div className="w-16 h-16 bg-slate-800 rounded-full flex items-center justify-center mb-4 border border-slate-700">
              <Shield className="text-amber-500" size={32} />
            </div>
            <h1 className="text-lg font-black tracking-tighter text-white uppercase italic">Rumbo Libertad</h1>
            <p className="text-[10px] text-slate-500 font-bold uppercase tracking-[0.2em] mt-1">Transición • Orden</p>
          </div>
          
          <nav className="flex-1 p-4 space-y-2 overflow-y-auto">
            <NavButton active={activeTab === 'dashboard'} onClick={() => setActiveTab('dashboard')} icon={<BarChart3 size={18} />} label="Centro de Control" />
            <NavButton active={activeTab === 'security'} onClick={() => setActiveTab('security')} icon={<Lock size={18} />} label="Seguridad / Israel" />
            <NavButton active={activeTab === 'economy'} onClick={() => setActiveTab('economy')} icon={<Briefcase size={18} />} label="Economía / Davos" />
            <NavButton active={activeTab === 'tech'} onClick={() => setActiveTab('tech')} icon={<Cpu size={18} />} label="Plan Tecnológico" />
            <NavButton active={activeTab === 'lustration'} onClick={() => setActiveTab('lustration')} icon={<Scale size={18} />} label="Lustración" />
          </nav>

          <div className="p-6 border-t border-slate-800">
            <div className="flex items-center gap-3 p-3 bg-red-900/10 border border-red-900/30 rounded-lg text-red-500">
              <Users size={20} />
              <div className="text-[10px] font-bold uppercase leading-none">
                <p>Usuario: E. Bittar</p>
                <p className="text-red-700 mt-1 italic">Nivel: Administrador</p>
              </div>
            </div>
          </div>
        </aside>

        {/* Contenido Principal */}
        <main className="flex-1 overflow-y-auto bg-slate-950 p-4 md:p-8 custom-scrollbar">
          {loading ? (
            <div className="h-full flex flex-col items-center justify-center space-y-4">
              <div className="w-12 h-12 border-4 border-amber-500 border-t-transparent rounded-full animate-spin"></div>
              <p className="text-xs font-bold uppercase tracking-widest text-slate-500">Sincronizando Inteligencia...</p>
            </div>
          ) : (
            <div className="max-w-6xl mx-auto">
              <header className="mb-8 flex flex-col md:flex-row md:items-end justify-between gap-4 border-b border-slate-900 pb-6">
                <div>
                  <div className="flex items-center gap-2 text-[10px] font-bold text-amber-500 uppercase tracking-widest mb-2">
                    <span className="h-2 w-2 bg-amber-500 rounded-full animate-pulse"></span>
                    Terminal Estratégica Transición
                  </div>
                  <h1 className="text-4xl font-black text-white uppercase italic tracking-tighter">Plan Maestro</h1>
                </div>
                <div className="flex gap-2">
                  <button className="px-4 py-2 bg-slate-800 hover:bg-slate-700 text-xs font-bold uppercase rounded border border-slate-700 transition-all">Exportar PDF</button>
                  <button className="px-4 py-2 bg-amber-600 hover:bg-amber-500 text-slate-950 text-xs font-bold uppercase rounded transition-all">Ejecutar Comando</button>
                </div>
              </header>

              {renderContent()}
            </div>
          )}
        </main>
      </div>

      <style jsx>{`
        .custom-scrollbar::-webkit-scrollbar {
          width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
          background: #020617;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
          background: #1e293b;
          border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
          background: #334155;
        }
      `}</style>
    </div>
  );
};

// Componentes Auxiliares
const NavButton = ({ active, onClick, icon, label }) => (
  <button 
    onClick={onClick}
    className={`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-bold transition-all ${
      active ? 'bg-amber-500 text-black shadow-lg shadow-amber-500/10' : 'text-slate-500 hover:bg-slate-800 hover:text-slate-300'
    }`}
  >
    {icon}
    <span>{label}</span>
  </button>
);

const MetricCard = ({ title, value, status, icon, color = "text-white" }) => (
  <div className="bg-slate-900 border border-slate-800 p-5 rounded-xl">
    <div className="flex items-center justify-between mb-2">
      <span className="text-[10px] font-bold text-slate-500 uppercase tracking-wider">{title}</span>
      {icon}
    </div>
    <div className={`text-2xl font-black ${color} tracking-tight`}>{value}</div>
    <div className="text-[10px] text-slate-600 font-bold uppercase mt-1 italic">{status}</div>
  </div>
);

const TaskItem = ({ title, desc, status }) => (
  <div className="p-4 bg-slate-800/40 border border-slate-800 rounded-lg hover:border-slate-600 transition-all group">
    <div className="flex justify-between items-start mb-2">
      <h4 className="text-sm font-bold text-white group-hover:text-amber-400 transition-colors">{title}</h4>
      <span className="text-[9px] px-2 py-0.5 bg-slate-700 text-slate-300 rounded uppercase font-bold">{status}</span>
    </div>
    <p className="text-xs text-slate-500 leading-relaxed">{desc}</p>
  </div>
);

const TimelineStep = ({ step, desc }) => (
  <div className="relative pl-8">
    <div className="absolute left-[-9px] top-1.5 w-4 h-4 rounded-full bg-slate-900 border-2 border-amber-500"></div>
    <h4 className="text-sm font-bold text-white uppercase tracking-tighter mb-1">{step}</h4>
    <p className="text-xs text-slate-500 max-w-xl">{desc}</p>
  </div>
);

export default App;
